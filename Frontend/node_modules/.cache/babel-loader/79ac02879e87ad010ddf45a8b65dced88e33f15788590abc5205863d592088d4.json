{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function WebcamRecorder(){const[isRecording,setIsRecording]=useState(false);const[stream,setStream]=useState(null);const videoRef=useRef(null);const canvasRef=useRef(null);const mediaRecorderRef=useRef(null);const recordedChunks=useRef([]);const captureInterval=useRef(null);useEffect(()=>{startRecording();function handleResize(){if(videoRef.current&&canvasRef.current){const videoHeight=window.innerHeight*0.9;videoRef.current.style.maxHeight=\"\".concat(videoHeight,\"px\");canvasRef.current.style.maxHeight=\"\".concat(videoHeight,\"px\");}}handleResize();window.addEventListener('resize',handleResize);return()=>{window.removeEventListener('resize',handleResize);};},[]);const startRecording=async()=>{try{const constraints={video:{width:720,height:1280}};const newStream=await navigator.mediaDevices.getUserMedia(constraints);setStream(newStream);const mediaRecorder=new MediaRecorder(newStream);mediaRecorder.start();setIsRecording(true);mediaRecorderRef.current=mediaRecorder;mediaRecorder.ondataavailable=event=>{recordedChunks.current.push(event.data);};mediaRecorder.onstop=()=>{const blob=new Blob(recordedChunks.current,{type:'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"'});const url=URL.createObjectURL(blob);console.log('Recorded video URL:',url);recordedChunks.current=[];};videoRef.current.srcObject=newStream;captureInterval.current=setInterval(captureImage,5000);}catch(error){console.error('Error accessing webcam:',error);}};function stopRecording(){if(mediaRecorderRef.current&&mediaRecorderRef.current.state!=='inactive'){mediaRecorderRef.current.stop();}if(stream){stream.getTracks().forEach(track=>track.stop());setStream(null);videoRef.current.srcObject=null;}if(captureInterval.current){clearInterval(captureInterval.current);}setIsRecording(false);window.location.replace(\"http://localhost:3000/\");};function captureImage(){const canvas=canvasRef.current;const video=videoRef.current;canvas.width=video.videoWidth;canvas.height=video.videoHeight;canvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);const imageDataUrl=canvas.toDataURL('image/jpeg');console.log('Captured image:',imageDataUrl);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"video\",{className:\"recording\",ref:videoRef,autoPlay:true}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{display:'none'}}),/*#__PURE__*/_jsx(\"div\",{children:isRecording?/*#__PURE__*/_jsx(\"button\",{className:\"button stop\",onClick:stopRecording,children:\"Stop Recording\"}):null})]});};export default WebcamRecorder;","map":{"version":3,"names":["React","useState","useRef","useEffect","jsx","_jsx","jsxs","_jsxs","WebcamRecorder","isRecording","setIsRecording","stream","setStream","videoRef","canvasRef","mediaRecorderRef","recordedChunks","captureInterval","startRecording","handleResize","current","videoHeight","window","innerHeight","style","maxHeight","concat","addEventListener","removeEventListener","constraints","video","width","height","newStream","navigator","mediaDevices","getUserMedia","mediaRecorder","MediaRecorder","start","ondataavailable","event","push","data","onstop","blob","Blob","type","url","URL","createObjectURL","console","log","srcObject","setInterval","captureImage","error","stopRecording","state","stop","getTracks","forEach","track","clearInterval","location","replace","canvas","videoWidth","getContext","drawImage","imageDataUrl","toDataURL","children","className","ref","autoPlay","display","onClick"],"sources":["/Users/jonchen/Documents/HackPSU/s24hackpsu/src/components/recorder.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\n\nfunction WebcamRecorder() {\n    const [isRecording, setIsRecording] = useState(false);\n    const [stream, setStream] = useState(null);\n    const videoRef = useRef(null);\n    const canvasRef = useRef(null);\n    const mediaRecorderRef = useRef(null);\n    const recordedChunks = useRef([]);\n    const captureInterval = useRef(null);\n\n    useEffect(() => {\n        startRecording()\n        function handleResize() {\n            if (videoRef.current && canvasRef.current) {\n                const videoHeight = window.innerHeight * 0.9;\n                videoRef.current.style.maxHeight = `${videoHeight}px`;\n                canvasRef.current.style.maxHeight = `${videoHeight}px`;\n            }\n        }\n\n        handleResize();\n        window.addEventListener('resize', handleResize);\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n\n    const startRecording = async () => {\n        try {\n            const constraints = { video: { width: 720, height: 1280 } };\n            const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n            setStream(newStream);\n            const mediaRecorder = new MediaRecorder(newStream);\n\n            mediaRecorder.start();\n            setIsRecording(true);\n\n            mediaRecorderRef.current = mediaRecorder;\n            mediaRecorder.ondataavailable = (event) => {\n                recordedChunks.current.push(event.data);\n            };\n\n            mediaRecorder.onstop = () => {\n                const blob = new Blob(recordedChunks.current, { type: 'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"' });\n                const url = URL.createObjectURL(blob);\n                console.log('Recorded video URL:', url);\n                recordedChunks.current = [];\n            };\n\n            videoRef.current.srcObject = newStream;\n            captureInterval.current = setInterval(captureImage, 5000);\n        } catch (error) {\n            console.error('Error accessing webcam:', error);\n        }\n    };\n\n    function stopRecording() {\n        if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n            mediaRecorderRef.current.stop();\n        }\n        if (stream) {\n            stream.getTracks().forEach((track) => track.stop());\n            setStream(null);\n            videoRef.current.srcObject = null;\n        }\n        if (captureInterval.current) {\n            clearInterval(captureInterval.current);\n        }\n        setIsRecording(false);\n        window.location.replace(\"http://localhost:3000/\")\n    };\n\n    function captureImage() {\n        const canvas = canvasRef.current;\n        const video = videoRef.current;\n        canvas.width = video.videoWidth;\n        canvas.height = video.videoHeight;\n        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n        const imageDataUrl = canvas.toDataURL('image/jpeg');\n        console.log('Captured image:', imageDataUrl);\n    };\n\n\n    return (\n        <div>\n            <video className=\"recording\" ref={videoRef} autoPlay></video>\n            <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>\n            <div>\n                {isRecording ? (\n                    <button className=\"button stop\" onClick={stopRecording}>Stop Recording</button>\n                ) : null}\n            </div>\n        </div>\n    );\n};\n\nexport default WebcamRecorder;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}