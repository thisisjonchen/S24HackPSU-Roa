{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function WebcamRecorder(){const[isRecording,setIsRecording]=useState(false);const[stream,setStream]=useState(null);const videoRef=useRef(null);const canvasRef=useRef(null);const mediaRecorderRef=useRef(null);const recordedChunks=useRef([]);const captureInterval=useRef(null);useEffect(()=>{startRecording();function handleResize(){if(videoRef.current&&canvasRef.current){const videoHeight=window.innerHeight*0.9;videoRef.current.style.maxHeight=\"\".concat(videoHeight,\"px\");canvasRef.current.style.maxHeight=\"\".concat(videoHeight,\"px\");}}handleResize();window.addEventListener('resize',handleResize);return()=>{window.removeEventListener('resize',handleResize);};},[]);const startRecording=async()=>{try{const constraints={video:{width:720,height:1280}};const newStream=await navigator.mediaDevices.getUserMedia(constraints);setStream(newStream);const mediaRecorder=new MediaRecorder(newStream);mediaRecorder.start();setIsRecording(true);mediaRecorderRef.current=mediaRecorder;mediaRecorder.ondataavailable=event=>{recordedChunks.current.push(event.data);};mediaRecorder.onstop=()=>{const blob=new Blob(recordedChunks.current,{type:'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"'});const url=URL.createObjectURL(blob);console.log('Recorded video URL:',url);recordedChunks.current=[];};videoRef.current.srcObject=newStream;captureInterval.current=setInterval(captureImage,5000);// capture img every 5 secs\n}catch(error){console.error('Error accessing webcam:',error);}};function stopRecording(){if(mediaRecorderRef.current&&mediaRecorderRef.current.state!=='inactive'){mediaRecorderRef.current.stop();}if(stream){stream.getTracks().forEach(track=>track.stop());setStream(null);videoRef.current.srcObject=null;}if(captureInterval.current){clearInterval(captureInterval.current);}setIsRecording(false);window.location.replace(\"https://www.roai.tech/\");//TODO REPLACE URL AFTER TESTING!\n}// captures image (every 5 seconds) and sends to backend for processing\nfunction captureImage(){const canvas=canvasRef.current;const video=videoRef.current;canvas.width=video.videoWidth;canvas.height=video.videoHeight;canvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);const imageDataUrl=canvas.toDataURL('image/jpeg');console.log('Captured image:',imageDataUrl);const formData=new FormData();formData.append('image',imageDataUrl);///fetch(\"https://example.com/upload\", {\n///    method: 'POST',\n///    body: formData\n///})\n///    .then(response => {\n///        if (response.ok) {\n///            console.log('Image uploaded successfully.');\n///        } else {\n///            console.error('Failed to upload image:', response.statusText);\n///        }\n///    })\n///    .catch(error => {\n///        console.error('Error uploading image:', error);\n///    });\n}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:isRecording?/*#__PURE__*/_jsx(\"video\",{className:\"recording\",ref:videoRef,autoPlay:true}):null}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{display:'none'}}),/*#__PURE__*/_jsx(\"div\",{children:isRecording?/*#__PURE__*/_jsx(\"button\",{className:\"button stop\",onClick:stopRecording,children:\"Stop Recording\"}):/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"alignMiddle stack\",style:{color:\"white\"},children:[\"Not working?\",/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"bold\"},children:\"Check your phone!\"})]})})})]});}export default WebcamRecorder;","map":{"version":3,"names":["React","useState","useRef","useEffect","jsx","_jsx","jsxs","_jsxs","WebcamRecorder","isRecording","setIsRecording","stream","setStream","videoRef","canvasRef","mediaRecorderRef","recordedChunks","captureInterval","startRecording","handleResize","current","videoHeight","window","innerHeight","style","maxHeight","concat","addEventListener","removeEventListener","constraints","video","width","height","newStream","navigator","mediaDevices","getUserMedia","mediaRecorder","MediaRecorder","start","ondataavailable","event","push","data","onstop","blob","Blob","type","url","URL","createObjectURL","console","log","srcObject","setInterval","captureImage","error","stopRecording","state","stop","getTracks","forEach","track","clearInterval","location","replace","canvas","videoWidth","getContext","drawImage","imageDataUrl","toDataURL","formData","FormData","append","children","className","ref","autoPlay","display","onClick","color","fontWeight"],"sources":["/Users/jonchen/Documents/HackPSU/s24hackpsu/src/components/recorder.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\n\nfunction WebcamRecorder() {\n    const [isRecording, setIsRecording] = useState(false);\n    const [stream, setStream] = useState(null);\n    const videoRef = useRef(null);\n    const canvasRef = useRef(null);\n    const mediaRecorderRef = useRef(null);\n    const recordedChunks = useRef([]);\n    const captureInterval = useRef(null);\n\n    useEffect(() => {\n        startRecording()\n        function handleResize() {\n            if (videoRef.current && canvasRef.current) {\n                const videoHeight = window.innerHeight * 0.9;\n                videoRef.current.style.maxHeight = `${videoHeight}px`;\n                canvasRef.current.style.maxHeight = `${videoHeight}px`;\n            }\n        }\n\n        handleResize();\n        window.addEventListener('resize', handleResize);\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        };\n    }, []);\n\n    const startRecording = async () => {\n        try {\n            const constraints = { video: { width: 720, height: 1280 } };\n            const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n            setStream(newStream);\n            const mediaRecorder = new MediaRecorder(newStream);\n\n            mediaRecorder.start();\n            setIsRecording(true);\n\n            mediaRecorderRef.current = mediaRecorder;\n            mediaRecorder.ondataavailable = (event) => {\n                recordedChunks.current.push(event.data);\n            };\n\n            mediaRecorder.onstop = () => {\n                const blob = new Blob(recordedChunks.current, { type: 'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"' });\n                const url = URL.createObjectURL(blob);\n                console.log('Recorded video URL:', url);\n                recordedChunks.current = [];\n            };\n\n            videoRef.current.srcObject = newStream;\n            captureInterval.current = setInterval(captureImage, 5000); // capture img every 5 secs\n        } catch (error) {\n            console.error('Error accessing webcam:', error);\n        }\n    }\n\n    function stopRecording() {\n        if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n            mediaRecorderRef.current.stop();\n        }\n        if (stream) {\n            stream.getTracks().forEach((track) => track.stop());\n            setStream(null);\n            videoRef.current.srcObject = null;\n        }\n        if (captureInterval.current) {\n            clearInterval(captureInterval.current);\n        }\n        setIsRecording(false);\n        window.location.replace(\"https://www.roai.tech/\") //TODO REPLACE URL AFTER TESTING!\n    }\n\n    // captures image (every 5 seconds) and sends to backend for processing\n    function captureImage() {\n        const canvas = canvasRef.current;\n        const video = videoRef.current;\n        canvas.width = video.videoWidth;\n        canvas.height = video.videoHeight;\n        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n        const imageDataUrl = canvas.toDataURL('image/jpeg');\n        console.log('Captured image:', imageDataUrl);\n        const formData = new FormData();\n        formData.append('image', imageDataUrl);\n\n        ///fetch(\"https://example.com/upload\", {\n        ///    method: 'POST',\n        ///    body: formData\n        ///})\n        ///    .then(response => {\n        ///        if (response.ok) {\n        ///            console.log('Image uploaded successfully.');\n        ///        } else {\n        ///            console.error('Failed to upload image:', response.statusText);\n        ///        }\n        ///    })\n        ///    .catch(error => {\n        ///        console.error('Error uploading image:', error);\n        ///    });\n    }\n\n    return (\n        <div>\n            <div>\n                {isRecording ? <video className=\"recording\" ref={videoRef} autoPlay></video> : null}\n            </div>\n            <canvas ref={canvasRef} style={{ display: 'none' }}></canvas>\n            <div>\n                {isRecording ? (\n                    <button className=\"button stop\" onClick={stopRecording}>Stop Recording</button>\n                ) :  (\n                    <div className=\"container\">\n                        <h2 className=\"alignMiddle stack\" style={{color:\"white\"}}>Not working?<span style={{fontWeight:\"bold\"}}>Check your phone!</span></h2>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default WebcamRecorder;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}